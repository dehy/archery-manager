{% extends 'base_unauthenticated.html.twig' %}

{% block title %}Créer un compte{% endblock %}

{% block body %}
    {% for flash_error in app.flashes('verify_email_error') %}
        <div class="alert alert-danger" role="alert">{{ flash_error }}</div>
    {% endfor %}
    
    {% for message in app.flashes('danger') %}
        <div class="alert alert-danger" role="alert">
            <em class="fa-solid fa-exclamation-triangle me-2"></em>
            {{ message }}
        </div>
    {% endfor %}
    
    {% for message in app.flashes('success') %}
        <div class="alert alert-success" role="alert">
            <em class="fa-solid fa-check-circle me-2"></em>
            {{ message }}
        </div>
    {% endfor %}

    <div class="card">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">
                <em class="fa-solid fa-user-plus me-2"></em>
                Créer un compte
            </h5>
        </div>
        <div class="card-body">
            <div class="alert alert-warning">
                <em class="fa-solid fa-exclamation-triangle me-2"></em>
                <strong>Important :</strong> Vous devez avoir au moins 15 ans pour créer un compte. 
                Les mineurs de moins de 15 ans doivent être inscrits par un parent ou tuteur légal. 
                Les informations du mineur seront demandées ultérieurement lors de la demande d'adhésion au club.
            </div>

            <p class="text-muted mb-4">
                Créez votre compte pour pouvoir faire une demande d'adhésion et rejoindre un club de tir à l'arc.
            </p>

            {% form_theme registrationForm 'bootstrap_5_layout.html.twig' %}
            {{ form_start(registrationForm) }}
                {{ form_row(registrationForm.gender) }}
                
                <div class="row">
                    <div class="col-md-6">
                        {{ form_row(registrationForm.firstname) }}
                    </div>
                    <div class="col-md-6">
                        {{ form_row(registrationForm.lastname) }}
                    </div>
                </div>
                
                {{ form_row(registrationForm.birthdate) }}
                {{ form_row(registrationForm.email) }}
                {{ form_row(registrationForm.phoneNumber) }}
                
                <div data-controller="password-strength" data-password-strength-min-score-value="2">
                    {{ form_label(registrationForm.plainPassword) }}
                    {{ form_widget(registrationForm.plainPassword, {
                        attr: {
                            'data-password-strength-target': 'input',
                            'data-action': 'input->password-strength#checkStrength'
                        }
                    }) }}
                    
                    <div data-password-strength-target="meter" class="mt-2" style="display: none;">
                        <div class="progress" style="height: 10px;">
                            <div data-password-strength-target="bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                        </div>
                        <small data-password-strength-target="text" class="form-text text-muted"></small>
                    </div>
                    
                    <small class="form-text text-muted">Choisissez un mot de passe fort. L'indicateur ci-dessus vous aide à évaluer sa robustesse.</small>
                    {{ form_errors(registrationForm.plainPassword) }}
                </div>
                
                {{ form_row(registrationForm.agreeTerms, {
                    label: 'J\'accepte les <a href="' ~ path('app_legal_cgu') ~ '" target="_blank">conditions générales d\'utilisation</a> *'|raw
                }) }}

                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-primary">
                        <em class="fa-solid fa-user-plus me-2"></em>
                        Créer mon compte
                    </button>
                </div>
            {{ form_end(registrationForm) }}

            <hr class="my-4">
            
            <div class="text-center">
                <p class="mb-0">Vous avez déjà un compte ?</p>
                <a href="{{ path('app_login') }}" class="btn btn-link">
                    <em class="fa-solid fa-arrow-right-to-bracket me-2"></em>
                    Se connecter
                </a>
            </div>
        </div>
    </div>
{% endblock %}
